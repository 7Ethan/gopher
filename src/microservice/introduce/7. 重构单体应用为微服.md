## 概述

不要使用的策略是“大爆炸”重写。。您可以逐
渐添加新功能，并以微服务的形式创建现有功能的扩展 — 以互补的
形式修改单体应用，并且一同运行微服务和修改后的单体应用。随
着时间推移，单体应用程序实现的功能量会缩小，直到它完全消失
或变成另一个微服务。

## 策略一：停止挖掘

应该停止扩张，避免使单体变得更大。相反，这一策略的主要思想
是将新代码放在独立的微服务中。

一个服务很少孤立存在，通常需要访问单体应用的数据。位于单体应用、微服务或两者中的粘合代码负责数据集成。该微服务**使用粘合代码来读取和写入单体应用数据。**

服务可以使用三种策略来访问单体应用的数据：
1. 调用由单体应用提供的远程 API
2. 直接访问单体应用的数据库
3. 维护自己的数据副本，与单体应用的数据库同步

粘合代码有时被称为防护层（anti-corruption layer）。这是因为粘合代码阻止了服务被遗留的单体应用领域模型的概念所污染，这些服务拥有属于自己的新的领域模型。

## 策略二：前后端分离

一个典型的企业应用由至少三种不同类型的组件组成：
* 表现层（Presentation Layer，PL）
  
处理 HTTP 请求并实现（REST）API 或基于 HTML 的 Web UI组件。在具有复杂用户界面的应用中，表现层通常存在大量代
码。

* 业务逻辑层（Business Logic Layer，BLL）

作为应用程序核心，实现业务规则的组件。

* 数据访问层（Data Access Layer，DAL）

访问基础架构组件的组件，如数据库和消息代理。

## 策略三：提取服务

第三个重构策略是将庞大的现有模块转变为独立的微服务。每次提取一个模块并将其转换成微服务时，单体就会缩小。

### 1.优先将哪些模块转换为微服务

一个好的方法是从容易提取的几个模块开始。

提取单体应用中相对来说耗资源的模块也是有益的。

同样，提取实现了大量复杂算法的模块也是值得的，因为该服务可以部署在具有大量 CPU 的主机上。

### 2.如何提取模块

第一步是在模块和单体应用之间定义一个粗粒度的接口。它很可能是一个双向 API，因为单体应用需要服务拥有的数据，反之亦然。

**要做到这点，您必须编写代码以使单体应用和服务通过使用进程间通信（IPC）机制的 API 进行通信。**

第二个重构步骤是将模块转换为一个独立服务。入站和出站接口使用 IPC 机制的代码来实现。

---

一旦提取了一个模块，就可以独立于单体应用和任何其他服务
开发、部署和扩展服务。

## 总结

将现有应用程序迁移到微服务的过程是应用程序现代化的一种形
式。不应该从头开始重写您的应用来迁移到微服务。相反，应该将应用程序逐渐重构为一组微服务。

可以使用这三种策略：将新功能实现为微服务；从业务组件和数据访问组件中分离出表现组件；将单体中的现有模块转换为服务。